# MySQL/MariaDB Configuration for Magento
# This file contains optimized settings for Magento e-commerce platform
# Place this file in /etc/mysql/conf.d/ directory inside the container

[mysqld]
# ===========================================
# BASIC CONFIGURATION
# ===========================================

# Maximum packet size - Important for large data operations
max_allowed_packet = 64M

# ===========================================
# INNODB CONFIGURATION
# ===========================================

# InnoDB Buffer Pool - Main memory area for caching data and indexes
# Default: 128MB or 25% of RAM (whichever is smaller)
# Optimized for: Better read/write performance for large databases
innodb_buffer_pool_size = 1G

# InnoDB Log Buffer - Buffer for log entries before writing to disk
# Default: 16MB
# Optimized for: Reducing disk I/O for large transactions
innodb_log_buffer_size = 64M

# InnoDB Log File Size - Size of each log file
# Default: 48MB
# Optimized for: Better transaction handling and recovery
innodb_log_file_size = 256M

# InnoDB Flush Method - How InnoDB flushes data to disk
# Default: fsync
# Optimized for: Better performance on modern systems
innodb_flush_method = O_DIRECT

# InnoDB I/O Capacity - Number of I/O operations per second
# Default: 200
# Optimized for: SSD storage (2000 IOPS)
innodb_io_capacity = 2000

# InnoDB Read/Write I/O Threads - Number of background threads
# Default: 4/4
# Optimized for: Better concurrent I/O operations
innodb_read_io_threads = 4
innodb_write_io_threads = 4

# InnoDB Flush Log at Transaction Commit
# Default: 1 (safest)
# Optimized for: Better performance (less safe but faster)
# 0 = Write and flush once per second
# 1 = Write and flush at each commit (safest)
# 2 = Write at commit, flush once per second
innodb_flush_log_at_trx_commit = 2

# ===========================================
# QUERY CACHE CONFIGURATION
# ===========================================

# Query Cache Size - Memory for caching query results
# Default: 0 (disabled)
# Optimized for: Faster repeated queries
query_cache_size = 64M

# Query Cache Type - Enable/disable query cache
# Default: 0 (disabled)
# Optimized for: Caching SELECT query results
query_cache_type = 1

# ===========================================
# MYISAM CONFIGURATION
# ===========================================

# Key Buffer Size - Memory for MyISAM key cache
# Default: 8MB
# Optimized for: MyISAM tables (if any)
key_buffer_size = 256M

# ===========================================
# BUFFER CONFIGURATION
# ===========================================

# Sort Buffer Size - Memory for sorting operations
# Default: 2MB
# Optimized for: Large sorting operations
sort_buffer_size = 4M

# Read Buffer Size - Memory for sequential table scans
# Default: 131KB
# Optimized for: Large table scans
read_buffer_size = 2M

# Read Random Buffer Size - Memory for random table access
# Default: 256KB
# Optimized for: Random table access patterns
read_rnd_buffer_size = 8M

# Join Buffer Size - Memory for join operations
# Default: 256KB
# Optimized for: Complex join queries
join_buffer_size = 4M

# ===========================================
# TABLE CONFIGURATION
# ===========================================

# Temporary Table Size - Memory for temporary tables
# Default: 16MB
# Optimized for: Large temporary operations
tmp_table_size = 64M

# Max Heap Table Size - Maximum size for MEMORY tables
# Default: 16MB
# Optimized for: Large memory tables
max_heap_table_size = 64M

# Table Open Cache - Number of open tables to cache
# Default: 2000
# Optimized for: Applications with many tables
table_open_cache = 2000

# ===========================================
# THREAD CONFIGURATION
# ===========================================

# Thread Cache Size - Number of threads to cache
# Default: 0 (disabled)
# Optimized for: Applications with many connections
thread_cache_size = 16

# ===========================================
# OPTIMIZER CONFIGURATION
# ===========================================

# Optimizer Use Condition Selectivity
# Default: 1 (enabled)
# Optimized for: Better query optimization
optimizer_use_condition_selectivity = 1

# Optimizer Switch - Control optimizer behavior
# Default: Various settings
# Optimized for: Disable rowid filter for better performance
optimizer_switch = "rowid_filter=off"
